var smartbutton=angular.module("SMARTBUTTON",[],["$interpolateProvider",function(a){a.startSymbol("--__");a.endSymbol("__--")}]);smartbutton.directive("smartButton",["SmartButton",function(b){var a="0.1";function c(f,e,d){}return{templateUrl:function(){var d=document.URL;d=d.split("public");return d[0]+"public/js/core/smartButton/smartButton-"+a+".html"},restrict:"E",scope:{btnId:"=btnid",label:"@label"},controller:["$scope","$element","$attrs","$rootScope","$timeout","$interval",function(g,f,e,d,h,i){var j=this;h(function(){if(g.btnObj.externalLabel!=""){g.label=g.btnObj.externalLabel;g.show.label=g.btnObj.externalLabel;g.btnObj.externalLabel=""}},2000);f.find("button").attr("id",g.btnId+"btn");f.find("button").attr("class",f.attr("class"));f.attr("class","");g.show={label:g.label,disabled:false,labelRefresher:{}};g.btnObj=b.getBtn(g.btnId).getObj();this.elapsedFromLastClick=function(){var p=g.btnObj.clickTs[g.btnObj.clickTs.length-1];if(typeof(p)==="undefined"){return"noclick"}var n=new Date();var m=n.getTime();var l=m-Number(p);var k=Math.floor(l/(1000*60*60));l=l-(k*(1000*60*60));var o=Math.floor(l/(1000*60));l=l-(o*(1000*60));var q=Math.floor(l/1000);return k+":"+o+":"+q};g.click=function(){return(g.btnObj.click)(g.btnId)};this.disable=function(){g.show.disabled=true;var k=g.btnObj.whatToShow.disabled;if(g.show.labelRefresher.$$intervalId){i.cancel(g.show.labelRefresher)}g.show.labelRefresher={};if(!k||k===""){g.show.label=g.label}else{switch(k){case"elapsedFromLastClick":j.setLabelRefresher(j.elapsedFromLastClick);break;case"wait":g.show.label="Attendere...";break;default:g.label}}};this.enable=function(){g.show.disabled=false;var k=g.btnObj.whatToShow.enabled;if(g.show.labelRefresher.$$intervalId){i.cancel(g.show.labelRefresher)}g.show.labelRefresher={};if(!k||k===""){g.show.label=g.label}else{switch(k){case"elapsedFromLastClick":j.setLabelRefresher(j.elapsedFromLastClick());break;case"wait":g.show.label="Attendere...";break;default:g.label}}};this.changeShowingLabel=function(k){g.show.label=k()};this.setLabelRefresher=function(k){g.show.labelRefresher=i(function(){j.changeShowingLabel(k)},500)};this.unsetLabelRefresher=function(k){i.cancel(g.show.labelRefresher);g.show.labelRefresher={}};this.getClass=function(){console.log("ciao");console.log(f.find("button"));console.log(f.find("button").attr("class"));return f.find("button").attr("class")};this.remClass=function(k){return f.find("button").removeClass(k)};this.setClass=function(k){return f.find("button").addClass(k)};b.getBtn(g.btnId).setDisableFcn(this.disable);b.getBtn(g.btnId).setEnableFcn(this.enable);b.getBtn(g.btnId).setClassGetter(this.getClass);b.getBtn(g.btnId).setClassRemover(this.remClass);b.getBtn(g.btnId).setClassSetter(this.setClass)}]}}]);smartbutton.provider("SmartButton",function(){this.randomString=function(c){var d="";var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var b=0;b<c;b++){d+=a.charAt(Math.floor(Math.random()*a.length))}return d};this.setTicket=function(){var a=true;while(a){var b=this.randomString(10);if(typeof(this.hash[b])==="undefined"){a=false}}this.hash[b]={disable:function(){},enable:function(){},click:function(){},getClass:function(){},setClass:function(){},remClass:function(){},enabled:true,clickNo:0,clickTs:[],whatToShow:{disabled:"",enabled:""},externalLabel:""};return[b,this.hash[b]]};this.lock=false;this.hash=[];this.$get=function(){var a=this;return{getBtn:function(b){return{setClickFcn:function(c){a.hash[b].click=function(d){a.hash[b].clickNo++;a.hash[b].clickTs.push((new Date()).getTime());return c(d)}},setDisableFcn:function(c){a.hash[b].disable=function(){a.hash[b].enabled=false;return c()}},setEnableFcn:function(c){a.hash[b].enable=function(){a.hash[b].enabled=true;return c()}},setClassGetter:function(c){a.hash[b].getClass=function(){return c()}},setClassSetter:function(c){a.hash[b].setClass=function(d){return c(d)}},setClassRemover:function(c){a.hash[b].remClass=function(d){return c(d)}},setWhatToShow:function(c){a.hash[b].whatToShow={disabled:c.disabled,enabled:c.enabled}},hide:function(){a.hash[calIndex].close()},canShow:function(){},setLabelGetter:function(c){a.hash[calIndex].labelGetter=function(d){return c(d)}},setLabelRetriever:function(c){a.hash[calIndex].labelRetriever=function(d){return c(d)}},setDataGetter:function(c){a.hash[calIndex].dataGetter=function(d){return c(d)}},setDataRetriever:function(c){a.hash[calIndex].dataRetriever=function(d){return c(d)}},setOnClick:function(c){a.hash[calIndex].onClick=function(d){return c(d)}},setOnMouseMove:function(c){a.hash[calIndex].onMouseMove=function(d){return c(d)}},setData:function(c){},getObj:function(){return a.hash[b]},setShapeInfoDisplayer:function(c){a.hash[calIndex].shapeInfoDisplayer=function(d){return c(d)}}}},getAll:function(){return a.hash},getGroupEnableCallback:function(b){if(typeof(b)==="object"){return function(e){for(var d in b){if(b.hasOwnProperty(d)){var c=b[d][0];if(e){a.hash[c].enable()}else{a.hash[c].disable()}}}}}else{return function(e){for(var d in b){var c=b[d];if(e){a.hash[c].enable()}else{a.hash[c].disable()}}}}},isDefined:function(b){return(typeof(a.hash[b])!=="undefined")},newBtn:function(){return a.setTicket()}}}});